(()=>{var e={429:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});const r=require("axios");var n=a.n(r),o=a(689),s=a.n(o);const i=function(e){const[t,a]=(0,o.useState)(!1),[r,i]=(0,o.useState)(""),[c,l]=(0,o.useState)(),[d,m]=(0,o.useState)("");return s().createElement("div",{className:"card"},s().createElement("div",{className:"our-card-top"},t&&s().createElement("div",{className:"our-custom-input"},s().createElement("div",{className:"our-custom-input-interior"},s().createElement("input",{onChange:e=>l(e.target.files[0]),className:"form-control form-control-sm",type:"file"}))),s().createElement("img",{src:e.photo?`/uploaded-photos/${e.photo}`:"/fallback.png",className:"card-img-top",alt:`${e.Role} named ${e.Name}`})),s().createElement("div",{className:"card-body"},!t&&s().createElement(s().Fragment,null,s().createElement("h4",null,e.Name),s().createElement("p",{className:"text-muted small"},e.Role),!e.readOnly&&s().createElement(s().Fragment,null,s().createElement("button",{onClick:()=>{a(!0),i(e.Name),m(e.Role),l("")},className:"btn btn-sm btn-primary"},"Edit")," ",s().createElement("button",{onClick:async()=>{n().delete(`/cricketer/${e.id}`),e.setCricketers((t=>t.filter((t=>t._id!=e.id))))},className:"btn btn-sm btn-outline-danger"},"Delete"))),t&&s().createElement("form",{onSubmit:async function(t){t.preventDefault(),a(!1),e.setCricketers((t=>t.map((function(t){return t._id==e.id?{...t,Name:r,Role:d}:t}))));const o=new FormData;c&&o.append("photo",c),o.append("_id",e.id),o.append("Name",r),o.append("Role",d);const s=await n().post("/update-cricketer",o,{headers:{"Content-Type":"multipart/form-data"}});s.data&&e.setCricketers((t=>t.map((function(t){return t._id==e.id?{...t,photo:s.data}:t}))))}},s().createElement("div",{className:"mb-1"},s().createElement("input",{autoFocus:!0,onChange:e=>i(e.target.value),type:"text",className:"form-control form-control-sm",value:r})),s().createElement("div",{className:"mb-2"},s().createElement("input",{onChange:e=>m(e.target.value),type:"text",className:"form-control form-control-sm",value:d})),s().createElement("button",{className:"btn btn-sm btn-success"},"Save")," ",s().createElement("button",{onClick:()=>a(!1),className:"btn btn-sm btn-outline-secondary"},"Cancel"))))}},860:e=>{"use strict";e.exports=require("express")},470:e=>{"use strict";e.exports=require("fs-extra")},13:e=>{"use strict";e.exports=require("mongodb")},738:e=>{"use strict";e.exports=require("multer")},689:e=>{"use strict";e.exports=require("react")},684:e=>{"use strict";e.exports=require("react-dom/server")},109:e=>{"use strict";e.exports=require("sanitize-html")},441:e=>{"use strict";e.exports=require("sharp")},17:e=>{"use strict";e.exports=require("path")}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=a(860),t=e(),r=a(738)(),n=a(109),{MongoClient:o,ObjectId:s}=a(13),i=a(470),c=a(441),l=a(17),d=a(689),m=a(684),u=a(429).Z;var p;function b(e,t,a){"string"!=typeof e.body.Name&&(e.body.Name=""),"string"!=typeof e.body.Role&&(e.body.Role=""),"string"!=typeof e.body._id&&(e.body._id=""),e.cleanData={Name:n(e.body.Name.trim(),{allowedTags:[],allowedAttributes:{}}),Role:n(e.body.Role.trim(),{allowedTags:[],allowedAttributes:{}})},a()}i.ensureDirSync(l.join("public","uploaded-photos")),t.set("view engine","ejs"),t.set("views","./views"),t.use(e.static("public")),t.use(e.json()),t.use(e.urlencoded({extended:!1})),t.get("/",(async(e,t)=>{const a=await p.collection("Cricketers").find().toArray(),r=m.renderToString(d.createElement("div",{className:"container"},!a.length&&d.createElement("p",null," There are no cricketers yet. The admin needs to add a few.  "),d.createElement("div",{className:"cricketer-grid mb-3"},d.createElement("p",null," ",d.createElement("a",{href:"/admin"}," Login / Manage the Cricketers List. ")),a.map((e=>d.createElement(u,{key:e._id,Name:e.Name,Role:e.Role,photo:e.photo,id:e._id,readOnly:!0}))))));t.render("Home",{generatedHTML:r})})),t.use((function(e,t,a){t.set("WWW-Authenticate","Basic realm='Our Mern APP'"),"Basic YWRtaW46YWRtaW4="==e.headers.authorization?a():(console.log(e.headers.authorization),t.status(401).send("Try again"))})),t.get("/admin",((e,t)=>{t.render("Admin")})),t.get("/cricketers",(async(e,t)=>{const a=await p.collection("Cricketers").find().toArray();t.json(a)})),t.post("/create-cricketer",r.single("photo"),b,(async(e,t)=>{if(e.file){const t=`${Date.now()}.jpg`;await c(e.file.buffer).resize(844,456).jpeg({quality:60}).toFile(l.join("public","uploaded-photos",t)),e.cleanData.photo=t}const a=await p.collection("Cricketers").insertOne(e.cleanData),r=await p.collection("Cricketers").findOne({_id:new s(a.insertedId)});t.send(r)})),t.delete("/cricketer/:id",(async(e,t)=>{"string"!=typeof e.params.id&&(e.params.id="");const a=await p.collection("Cricketers").findOne({_id:new s(e.params.id)});a.photo&&i.remove(l.join("public","uploaded-photos",a.photo)),p.collection("Cricketers").deleteOne({_id:new s(e.params.id)}),t.send("Thank you")})),t.post("/update-cricketer",r.single("photo"),b,(async(e,t)=>{if(e.file){const a=`${Date.now()}.jpg`;await c(e.file.buffer).resize(844,456).jpeg({quality:60}).toFile(l.join("public","uploaded-photos",a)),e.cleanData.photo=a;const r=await p.collection("Cricketers").findOneAndUpdate({_id:new s(e.body._id)},{$set:e.cleanData});r.value.photo&&i.remove(l.join("public","uploaded-photos",r.value.photo)),t.send(a)}else p.collection("Cricketers").findOneAndUpdate({_id:new s(e.body._id)},{$set:e.cleanData}),t.send(!1)})),async function(){const e=new o("mongodb://localhost:27017/MernApp?&authSource=admin");await e.connect(),p=e.db(),t.listen(3e3,(()=>console.log("The server has started")))}()})()})();